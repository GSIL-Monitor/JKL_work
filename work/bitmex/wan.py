import pandas as pd

fileName = 'wan.csv'
number = 2
ret = [{"timestamp": "2018-01-28T00:00:00.000Z", "symbol": "XBTUSD", "open": 11380, "high": 11401.5, "low": 11378,
        "close": 11398, "trades": 1229, "volume": 3401160, "vwap": 11392.1167, "lastSize": 6000,
        "turnover": 29856707071, "homeNotional": 298.5670707100001, "foreignNotional": 3401160},
       {"timestamp": "2018-01-28T00:05:00.000Z", "symbol": "XBTUSD", "open": 11398, "high": 11421, "low": 11385.5,
        "close": 11386, "trades": 968, "volume": 2923285, "vwap": 11412.9194, "lastSize": 50, "turnover": 25615126527,
        "homeNotional": 256.1512652699999, "foreignNotional": 2923285},
       {"timestamp": "2018-01-28T00:10:00.000Z", "symbol": "XBTUSD", "open": 11386, "high": 11467.5, "low": 11375.5,
        "close": 11431, "trades": 1442, "volume": 4102304, "vwap": 11439.03, "lastSize": 3000, "turnover": 35862730487,
        "homeNotional": 358.62730487, "foreignNotional": 4102304},
       {"timestamp": "2018-01-28T00:15:00.000Z", "symbol": "XBTUSD", "open": 11431, "high": 11460, "low": 11409.5,
        "close": 11431, "trades": 1047, "volume": 3762221, "vwap": 11431.1843, "lastSize": 25000,
        "turnover": 32912449938, "homeNotional": 329.12449938000003, "foreignNotional": 3762221},
       {"timestamp": "2018-01-28T00:20:00.000Z", "symbol": "XBTUSD", "open": 11431, "high": 11435, "low": 11410,
        "close": 11410.5, "trades": 599, "volume": 1696489, "vwap": 11419.4359, "lastSize": 871,
        "turnover": 14857151483, "homeNotional": 148.57151482999998, "foreignNotional": 1696489},
       {"timestamp": "2018-01-28T00:25:00.000Z", "symbol": "XBTUSD", "open": 11410.5, "high": 11424.5, "low": 11390,
        "close": 11420, "trades": 498, "volume": 1334052, "vwap": 11407.7116, "lastSize": 10937,
        "turnover": 11694942943, "homeNotional": 116.94942942999998, "foreignNotional": 1334052},
       {"timestamp": "2018-01-28T00:30:00.000Z", "symbol": "XBTUSD", "open": 11420, "high": 11479.5, "low": 11400.5,
        "close": 11476, "trades": 932, "volume": 3386608, "vwap": 11445.5763, "lastSize": 1000, "turnover": 29590481750,
        "homeNotional": 295.9048174999999, "foreignNotional": 3386608},
       {"timestamp": "2018-01-28T00:35:00.000Z", "symbol": "XBTUSD", "open": 11476, "high": 11514.5, "low": 11462.5,
        "close": 11512, "trades": 1393, "volume": 4060162, "vwap": 11494.2529, "lastSize": 600, "turnover": 35323951954,
        "homeNotional": 353.2395195400002, "foreignNotional": 4060162},
       {"timestamp": "2018-01-28T00:40:00.000Z", "symbol": "XBTUSD", "open": 11512, "high": 11537.5, "low": 11503.5,
        "close": 11525, "trades": 927, "volume": 3174445, "vwap": 11523.3925, "lastSize": 1604, "turnover": 27550727841,
        "homeNotional": 275.5072784100001, "foreignNotional": 3174445},
       {"timestamp": "2018-01-28T00:45:00.000Z", "symbol": "XBTUSD", "open": 11525, "high": 11588, "low": 11525,
        "close": 11571, "trades": 1180, "volume": 5220968, "vwap": 11555.3501, "lastSize": 200, "turnover": 45183191361,
        "homeNotional": 451.83191361, "foreignNotional": 5220968},
       {"timestamp": "2018-01-28T00:50:00.000Z", "symbol": "XBTUSD", "open": 11571, "high": 11600, "low": 11455,
        "close": 11459.5, "trades": 1850, "volume": 8081820, "vwap": 11526.0489, "lastSize": 100,
        "turnover": 70123679126, "homeNotional": 701.2367912600005, "foreignNotional": 8081820},
       {"timestamp": "2018-01-28T00:55:00.000Z", "symbol": "XBTUSD", "open": 11459.5, "high": 11504.5, "low": 11437,
        "close": 11486, "trades": 1209, "volume": 4961707, "vwap": 11471.8366, "lastSize": 1129,
        "turnover": 43253274770, "homeNotional": 432.53274769999996, "foreignNotional": 4961707},
       {"timestamp": "2018-01-28T01:00:00.000Z", "symbol": "XBTUSD", "open": 11486, "high": 11500, "low": 11462,
        "close": 11467, "trades": 551, "volume": 1660706, "vwap": 11479.7383, "lastSize": 6951, "turnover": 14467095237,
        "homeNotional": 144.67095237, "foreignNotional": 1660706},
       {"timestamp": "2018-01-28T01:05:00.000Z", "symbol": "XBTUSD", "open": 11467, "high": 11468.5, "low": 11419,
        "close": 11442, "trades": 1119, "volume": 3677855, "vwap": 11444.2664, "lastSize": 2400,
        "turnover": 32138906034, "homeNotional": 321.38906034, "foreignNotional": 3677855},
       {"timestamp": "2018-01-28T01:10:00.000Z", "symbol": "XBTUSD", "open": 11442, "high": 11528, "low": 11442,
        "close": 11492, "trades": 1031, "volume": 3482459, "vwap": 11485.0121, "lastSize": 151991,
        "turnover": 30324722760, "homeNotional": 303.2472276, "foreignNotional": 3482459},
       {"timestamp": "2018-01-28T01:15:00.000Z", "symbol": "XBTUSD", "open": 11492, "high": 11497.5, "low": 11420,
        "close": 11443, "trades": 925, "volume": 3379004, "vwap": 11444.2664, "lastSize": 100, "turnover": 29528276585,
        "homeNotional": 295.2827658500001, "foreignNotional": 3379004},
       {"timestamp": "2018-01-28T01:20:00.000Z", "symbol": "XBTUSD", "open": 11443, "high": 11463.5, "low": 11428,
        "close": 11443, "trades": 681, "volume": 1616842, "vwap": 11448.1969, "lastSize": 3943, "turnover": 14124433225,
        "homeNotional": 141.24433224999996, "foreignNotional": 1616842},
       {"timestamp": "2018-01-28T01:25:00.000Z", "symbol": "XBTUSD", "open": 11443, "high": 11460.5, "low": 11420,
        "close": 11420, "trades": 533, "volume": 977778, "vwap": 11439.03, "lastSize": 10763, "turnover": 8548113171,
        "homeNotional": 85.48113171, "foreignNotional": 977778},
       {"timestamp": "2018-01-28T01:30:00.000Z", "symbol": "XBTUSD", "open": 11420, "high": 11420.5, "low": 11390.5,
        "close": 11391.5, "trades": 844, "volume": 2820316, "vwap": 11398.6094, "lastSize": 1000,
        "turnover": 24742686989, "homeNotional": 247.42686988999992, "foreignNotional": 2820316},
       {"timestamp": "2018-01-28T01:35:00.000Z", "symbol": "XBTUSD", "open": 11391.5, "high": 11391.5, "low": 11353,
        "close": 11367.5, "trades": 1268, "volume": 3493723, "vwap": 11371.3896, "lastSize": 4992,
        "turnover": 30724699368, "homeNotional": 307.24699368, "foreignNotional": 3493723},
       {"timestamp": "2018-01-28T01:40:00.000Z", "symbol": "XBTUSD", "open": 11367.5, "high": 11413.5, "low": 11367.5,
        "close": 11401, "trades": 757, "volume": 1710392, "vwap": 11392.1167, "lastSize": 40, "turnover": 15014288052,
        "homeNotional": 150.14288051999998, "foreignNotional": 1710392},
       {"timestamp": "2018-01-28T01:45:00.000Z", "symbol": "XBTUSD", "open": 11401, "high": 11434.5, "low": 11401,
        "close": 11434.5, "trades": 720, "volume": 2074608, "vwap": 11420.7401, "lastSize": 1, "turnover": 18165537752,
        "homeNotional": 181.65537752000006, "foreignNotional": 2074608},
       {"timestamp": "2018-01-28T01:50:00.000Z", "symbol": "XBTUSD", "open": 11434.5, "high": 11462.5, "low": 11434,
        "close": 11452.5, "trades": 634, "volume": 2228533, "vwap": 11448.1969, "lastSize": 1219,
        "turnover": 19466894883, "homeNotional": 194.66894882999992, "foreignNotional": 2228533},
       {"timestamp": "2018-01-28T01:55:00.000Z", "symbol": "XBTUSD", "open": 11452.5, "high": 11488, "low": 11427.5,
        "close": 11430.5, "trades": 867, "volume": 3046654, "vwap": 11467.8899, "lastSize": 13732,
        "turnover": 26569139779, "homeNotional": 265.69139779, "foreignNotional": 3046654},
       {"timestamp": "2018-01-28T02:00:00.000Z", "symbol": "XBTUSD", "open": 11430.5, "high": 11450.5, "low": 11389.5,
        "close": 11427.5, "trades": 983, "volume": 2312771, "vwap": 11414.2221, "lastSize": 30, "turnover": 20263251167,
        "homeNotional": 202.63251166999999, "foreignNotional": 2312771},
       {"timestamp": "2018-01-28T02:05:00.000Z", "symbol": "XBTUSD", "open": 11427.5, "high": 11488.5, "low": 11400,
        "close": 11484, "trades": 1142, "volume": 4169052, "vwap": 11448.1969, "lastSize": 3775,
        "turnover": 36418088172, "homeNotional": 364.18088172, "foreignNotional": 4169052},
       {"timestamp": "2018-01-28T02:10:00.000Z", "symbol": "XBTUSD", "open": 11484, "high": 11488.5, "low": 11439,
        "close": 11439, "trades": 582, "volume": 1206575, "vwap": 11463.9459, "lastSize": 1381, "turnover": 10525786223,
        "homeNotional": 105.25786223, "foreignNotional": 1206575},
       {"timestamp": "2018-01-28T02:15:00.000Z", "symbol": "XBTUSD", "open": 11439, "high": 11445.5, "low": 11390.5,
        "close": 11413, "trades": 833, "volume": 2840270, "vwap": 11412.9194, "lastSize": 4741, "turnover": 24887955803,
        "homeNotional": 248.87955803, "foreignNotional": 2840270},
       {"timestamp": "2018-01-28T02:20:00.000Z", "symbol": "XBTUSD", "open": 11413, "high": 11424.5, "low": 11410,
        "close": 11420, "trades": 519, "volume": 853366, "vwap": 11415.5251, "lastSize": 600, "turnover": 7475698275,
        "homeNotional": 74.75698274999999, "foreignNotional": 853366},
       {"timestamp": "2018-01-28T02:25:00.000Z", "symbol": "XBTUSD", "open": 11420, "high": 11445.5, "low": 11395,
        "close": 11401, "trades": 574, "volume": 1341952, "vwap": 11419.4359, "lastSize": 2000, "turnover": 11751835623,
        "homeNotional": 117.51835623, "foreignNotional": 1341952},
       {"timestamp": "2018-01-28T02:30:00.000Z", "symbol": "XBTUSD", "open": 11401, "high": 11403, "low": 11375.5,
        "close": 11403, "trades": 1117, "volume": 2766083, "vwap": 11385.6313, "lastSize": 12750,
        "turnover": 24296460608, "homeNotional": 242.9646060800001, "foreignNotional": 2766083},
       {"timestamp": "2018-01-28T02:35:00.000Z", "symbol": "XBTUSD", "open": 11403, "high": 11405, "low": 11350,
        "close": 11405, "trades": 1187, "volume": 3308025, "vwap": 11366.2196, "lastSize": 50, "turnover": 29104176423,
        "homeNotional": 291.04176423, "foreignNotional": 3308025},
       {"timestamp": "2018-01-28T02:40:00.000Z", "symbol": "XBTUSD", "open": 11405, "high": 11405.5, "low": 11352.5,
        "close": 11352.5, "trades": 685, "volume": 1590311, "vwap": 11376.5643, "lastSize": 1746,
        "turnover": 13979813044, "homeNotional": 139.79813044, "foreignNotional": 1590311},
       {"timestamp": "2018-01-28T02:45:00.000Z", "symbol": "XBTUSD", "open": 11352.5, "high": 11381, "low": 11350,
        "close": 11377.5, "trades": 579, "volume": 1316904, "vwap": 11366.2196, "lastSize": 75, "turnover": 11586365584,
        "homeNotional": 115.86365583999998, "foreignNotional": 1316904},
       {"timestamp": "2018-01-28T02:50:00.000Z", "symbol": "XBTUSD", "open": 11377.5, "high": 11420, "low": 11377.5,
        "close": 11404.5, "trades": 681, "volume": 2544660, "vwap": 11398.6094, "lastSize": 2000,
        "turnover": 22325052756, "homeNotional": 223.25052756000002, "foreignNotional": 2544660},
       {"timestamp": "2018-01-28T02:55:00.000Z", "symbol": "XBTUSD", "open": 11404.5, "high": 11410, "low": 11357.5,
        "close": 11392, "trades": 690, "volume": 1704551, "vwap": 11381.7437, "lastSize": 73, "turnover": 14976561565,
        "homeNotional": 149.76561565, "foreignNotional": 1704551},
       {"timestamp": "2018-01-28T03:00:00.000Z", "symbol": "XBTUSD", "open": 11392, "high": 11410, "low": 11384.5,
        "close": 11385, "trades": 363, "volume": 548157, "vwap": 11396.0114, "lastSize": 50, "turnover": 4810590594,
        "homeNotional": 48.10590593999999, "foreignNotional": 548157},
       {"timestamp": "2018-01-28T03:05:00.000Z", "symbol": "XBTUSD", "open": 11385, "high": 11480.5, "low": 11384,
        "close": 11456, "trades": 1416, "volume": 5759753, "vwap": 11437.7216, "lastSize": 3000,
        "turnover": 50358815227, "homeNotional": 503.58815227, "foreignNotional": 5759753},
       {"timestamp": "2018-01-28T03:10:00.000Z", "symbol": "XBTUSD", "open": 11456, "high": 11466, "low": 11429.5,
        "close": 11440.5, "trades": 639, "volume": 1146191, "vwap": 11441.6476, "lastSize": 237,
        "turnover": 10017785217, "homeNotional": 100.17785217000001, "foreignNotional": 1146191},
       {"timestamp": "2018-01-28T03:15:00.000Z", "symbol": "XBTUSD", "open": 11440.5, "high": 11441, "low": 11420,
        "close": 11435.5, "trades": 578, "volume": 1788501, "vwap": 11429.8777, "lastSize": 22, "turnover": 15647626355,
        "homeNotional": 156.47626355000003, "foreignNotional": 1788501},
       {"timestamp": "2018-01-28T03:20:00.000Z", "symbol": "XBTUSD", "open": 11435.5, "high": 11440, "low": 11425.5,
        "close": 11440, "trades": 285, "volume": 570387, "vwap": 11433.7983, "lastSize": 10000, "turnover": 4989134103,
        "homeNotional": 49.89134103, "foreignNotional": 570387},
       {"timestamp": "2018-01-28T03:25:00.000Z", "symbol": "XBTUSD", "open": 11440, "high": 11440, "low": 11418,
        "close": 11431, "trades": 360, "volume": 1939505, "vwap": 11424.6544, "lastSize": 3000, "turnover": 16976807809,
        "homeNotional": 169.76807809, "foreignNotional": 1939505},
       {"timestamp": "2018-01-28T03:30:00.000Z", "symbol": "XBTUSD", "open": 11431, "high": 11493.5, "low": 11427.5,
        "close": 11480.5, "trades": 1052, "volume": 3638232, "vwap": 11470.5208, "lastSize": 500,
        "turnover": 31720848863, "homeNotional": 317.20848863000003, "foreignNotional": 3638232},
       {"timestamp": "2018-01-28T03:35:00.000Z", "symbol": "XBTUSD", "open": 11480.5, "high": 11480.5, "low": 11464,
        "close": 11469.5, "trades": 482, "volume": 828292, "vwap": 11469.2052, "lastSize": 1000, "turnover": 7222295662,
        "homeNotional": 72.22295662000002, "foreignNotional": 828292},
       {"timestamp": "2018-01-28T03:40:00.000Z", "symbol": "XBTUSD", "open": 11469.5, "high": 11471, "low": 11446,
        "close": 11469.5, "trades": 557, "volume": 1850996, "vwap": 11454.7537, "lastSize": 50, "turnover": 16160872384,
        "homeNotional": 161.60872384, "foreignNotional": 1850996},
       {"timestamp": "2018-01-28T03:45:00.000Z", "symbol": "XBTUSD", "open": 11469.5, "high": 11469.5, "low": 11445.5,
        "close": 11448.5, "trades": 386, "volume": 513472, "vwap": 11457.3786, "lastSize": 20, "turnover": 4481967968,
        "homeNotional": 44.81967968000001, "foreignNotional": 513472},
       {"timestamp": "2018-01-28T03:50:00.000Z", "symbol": "XBTUSD", "open": 11448.5, "high": 11448.5, "low": 11428,
        "close": 11434.5, "trades": 459, "volume": 1330841, "vwap": 11433.7983, "lastSize": 49563,
        "turnover": 11639637238, "homeNotional": 116.39637237999997, "foreignNotional": 1330841},
       {"timestamp": "2018-01-28T03:55:00.000Z", "symbol": "XBTUSD", "open": 11434.5, "high": 11449, "low": 11429,
        "close": 11437.5, "trades": 506, "volume": 1339506, "vwap": 11436.4135, "lastSize": 1742,
        "turnover": 11712675252, "homeNotional": 117.12675252, "foreignNotional": 1339506},
       {"timestamp": "2018-01-28T04:00:00.000Z", "symbol": "XBTUSD", "open": 11437.5, "high": 11438, "low": 11425.5,
        "close": 11426, "trades": 339, "volume": 802948, "vwap": 11432.4911, "lastSize": 150, "turnover": 7024009697,
        "homeNotional": 70.24009696999998, "foreignNotional": 802948},
       {"timestamp": "2018-01-28T04:05:00.000Z", "symbol": "XBTUSD", "open": 11426, "high": 11472.5, "low": 11426,
        "close": 11462, "trades": 725, "volume": 1936269, "vwap": 11460.0046, "lastSize": 1800, "turnover": 16897591516,
        "homeNotional": 168.97591515999997, "foreignNotional": 1936269},
       {"timestamp": "2018-01-28T04:10:00.000Z", "symbol": "XBTUSD", "open": 11462, "high": 11477, "low": 11447,
        "close": 11452, "trades": 491, "volume": 1147015, "vwap": 11466.5749, "lastSize": 500, "turnover": 10003720033,
        "homeNotional": 100.03720032999998, "foreignNotional": 1147015},
       {"timestamp": "2018-01-28T04:15:00.000Z", "symbol": "XBTUSD", "open": 11452, "high": 11478.5, "low": 11441,
        "close": 11478.5, "trades": 513, "volume": 1256322, "vwap": 11466.5749, "lastSize": 44, "turnover": 10957473959,
        "homeNotional": 109.57473959000001, "foreignNotional": 1256322},
       {"timestamp": "2018-01-28T04:20:00.000Z", "symbol": "XBTUSD", "open": 11478.5, "high": 11512, "low": 11478.5,
        "close": 11512, "trades": 948, "volume": 2245538, "vwap": 11494.2529, "lastSize": 578, "turnover": 19537099055,
        "homeNotional": 195.37099055000004, "foreignNotional": 2245538},
       {"timestamp": "2018-01-28T04:25:00.000Z", "symbol": "XBTUSD", "open": 11512, "high": 11550, "low": 11511.5,
        "close": 11537.5, "trades": 1394, "volume": 4216464, "vwap": 11540.6809, "lastSize": 1000,
        "turnover": 36539045386, "homeNotional": 365.39045386000015, "foreignNotional": 4216464},
       {"timestamp": "2018-01-28T04:30:00.000Z", "symbol": "XBTUSD", "open": 11537.5, "high": 11640, "low": 11515.5,
        "close": 11639, "trades": 2101, "volume": 11882847, "vwap": 11580.7759, "lastSize": 2000,
        "turnover": 102612311424, "homeNotional": 1026.1231142400002, "foreignNotional": 11882847},
       {"timestamp": "2018-01-28T04:35:00.000Z", "symbol": "XBTUSD", "open": 11639, "high": 11652, "low": 11555,
        "close": 11595, "trades": 2431, "volume": 10106861, "vwap": 11607.6611, "lastSize": 44, "turnover": 87077539917,
        "homeNotional": 870.7753991700001, "foreignNotional": 10106861},
       {"timestamp": "2018-01-28T04:40:00.000Z", "symbol": "XBTUSD", "open": 11595, "high": 11622, "low": 11561,
        "close": 11588, "trades": 1216, "volume": 3086812, "vwap": 11594.2029, "lastSize": 300, "turnover": 26626132532,
        "homeNotional": 266.26132531999997, "foreignNotional": 3086812},
       {"timestamp": "2018-01-28T04:45:00.000Z", "symbol": "XBTUSD", "open": 11588, "high": 11601, "low": 11575.5,
        "close": 11585.5, "trades": 667, "volume": 1478239, "vwap": 11586.143, "lastSize": 5, "turnover": 12759097090,
        "homeNotional": 127.5909709, "foreignNotional": 1478239},
       {"timestamp": "2018-01-28T04:50:00.000Z", "symbol": "XBTUSD", "open": 11585.5, "high": 11614, "low": 11580,
        "close": 11611.5, "trades": 905, "volume": 1857154, "vwap": 11599.5824, "lastSize": 21033,
        "turnover": 16010909929, "homeNotional": 160.10909929000002, "foreignNotional": 1857154},
       {"timestamp": "2018-01-28T04:55:00.000Z", "symbol": "XBTUSD", "open": 11611.5, "high": 11690, "low": 11599,
        "close": 11690, "trades": 1462, "volume": 5428353, "vwap": 11645.5107, "lastSize": 55, "turnover": 46613808147,
        "homeNotional": 466.13808147, "foreignNotional": 5428353},
       {"timestamp": "2018-01-28T05:00:00.000Z", "symbol": "XBTUSD", "open": 11690, "high": 11803, "low": 11679.5,
        "close": 11728, "trades": 2652, "volume": 13336118, "vwap": 11749.5006, "lastSize": 1022,
        "turnover": 113512152971, "homeNotional": 1135.1215297099998, "foreignNotional": 13336118},
       {"timestamp": "2018-01-28T05:05:00.000Z", "symbol": "XBTUSD", "open": 11728, "high": 11761.5, "low": 11716,
        "close": 11761.5, "trades": 1373, "volume": 4077373, "vwap": 11742.6022, "lastSize": 60,
        "turnover": 34724433220, "homeNotional": 347.24433219999986, "foreignNotional": 4077373},
       {"timestamp": "2018-01-28T05:10:00.000Z", "symbol": "XBTUSD", "open": 11761.5, "high": 11800, "low": 11743.5,
        "close": 11760.5, "trades": 1721, "volume": 6624683, "vwap": 11771.6304, "lastSize": 50,
        "turnover": 56278445864, "homeNotional": 562.7844586399999, "foreignNotional": 6624683},
       {"timestamp": "2018-01-28T05:15:00.000Z", "symbol": "XBTUSD", "open": 11760.5, "high": 11800, "low": 11744,
        "close": 11783.5, "trades": 1303, "volume": 4842846, "vwap": 11764.7059, "lastSize": 30000,
        "turnover": 41167578770, "homeNotional": 411.6757877000001, "foreignNotional": 4842846},
       {"timestamp": "2018-01-28T05:20:00.000Z", "symbol": "XBTUSD", "open": 11783.5, "high": 11875, "low": 11765.5,
        "close": 11871, "trades": 1733, "volume": 7060213, "vwap": 11816.1408, "lastSize": 55, "turnover": 59750638840,
        "homeNotional": 597.5063883999999, "foreignNotional": 7060213},
       {"timestamp": "2018-01-28T05:25:00.000Z", "symbol": "XBTUSD", "open": 11871, "high": 11875, "low": 11815,
        "close": 11825, "trades": 1689, "volume": 5986998, "vwap": 11842.7286, "lastSize": 4267,
        "turnover": 50557816174, "homeNotional": 505.57816174, "foreignNotional": 5986998},
       {"timestamp": "2018-01-28T05:30:00.000Z", "symbol": "XBTUSD", "open": 11825, "high": 11840, "low": 11789,
        "close": 11790.5, "trades": 1200, "volume": 4468651, "vwap": 11814.7448, "lastSize": 2011,
        "turnover": 37827054096, "homeNotional": 378.2705409600001, "foreignNotional": 4468651},
       {"timestamp": "2018-01-28T05:35:00.000Z", "symbol": "XBTUSD", "open": 11790.5, "high": 11791, "low": 11726,
        "close": 11728.5, "trades": 1624, "volume": 6983568, "vwap": 11763.322, "lastSize": 1172,
        "turnover": 59368569671, "homeNotional": 593.6856967099998, "foreignNotional": 6983568},
       {"timestamp": "2018-01-28T05:40:00.000Z", "symbol": "XBTUSD", "open": 11728.5, "high": 11788, "low": 11728.5,
        "close": 11749.5, "trades": 1093, "volume": 4947049, "vwap": 11757.7895, "lastSize": 55,
        "turnover": 42077452989, "homeNotional": 420.77452988999994, "foreignNotional": 4947049},
       {"timestamp": "2018-01-28T05:45:00.000Z", "symbol": "XBTUSD", "open": 11749.5, "high": 11776, "low": 11727,
        "close": 11763, "trades": 825, "volume": 1592727, "vwap": 11752.2623, "lastSize": 13510,
        "turnover": 13553214947, "homeNotional": 135.53214947, "foreignNotional": 1592727},
       {"timestamp": "2018-01-28T05:50:00.000Z", "symbol": "XBTUSD", "open": 11763, "high": 11790, "low": 11763,
        "close": 11773.5, "trades": 781, "volume": 1492633, "vwap": 11782.7265, "lastSize": 96893,
        "turnover": 12668628280, "homeNotional": 126.68628279999999, "foreignNotional": 1492633},
       {"timestamp": "2018-01-28T05:55:00.000Z", "symbol": "XBTUSD", "open": 11773.5, "high": 11809, "low": 11765.5,
        "close": 11781.5, "trades": 841, "volume": 2614582, "vwap": 11795.2347, "lastSize": 2, "turnover": 22166752721,
        "homeNotional": 221.66752721, "foreignNotional": 2614582},
       {"timestamp": "2018-01-28T06:00:00.000Z", "symbol": "XBTUSD", "open": 11781.5, "high": 11786, "low": 11757,
        "close": 11777, "trades": 577, "volume": 1314735, "vwap": 11768.8596, "lastSize": 50, "turnover": 11171850120,
        "homeNotional": 111.71850119999999, "foreignNotional": 1314735},
       {"timestamp": "2018-01-28T06:05:00.000Z", "symbol": "XBTUSD", "open": 11777, "high": 11790, "low": 11750.5,
        "close": 11789.5, "trades": 756, "volume": 1558837, "vwap": 11764.7059, "lastSize": 200,
        "turnover": 13250510970, "homeNotional": 132.50510970000002, "foreignNotional": 1558837},
       {"timestamp": "2018-01-28T06:10:00.000Z", "symbol": "XBTUSD", "open": 11789.5, "high": 11793, "low": 11768,
        "close": 11783, "trades": 484, "volume": 785202, "vwap": 11781.3384, "lastSize": 1000, "turnover": 6665222724,
        "homeNotional": 66.65222724, "foreignNotional": 785202},
       {"timestamp": "2018-01-28T06:15:00.000Z", "symbol": "XBTUSD", "open": 11783, "high": 11786, "low": 11774,
        "close": 11777, "trades": 375, "volume": 597491, "vwap": 11784.115, "lastSize": 305, "turnover": 5070714009,
        "homeNotional": 50.70714009, "foreignNotional": 597491},
       {"timestamp": "2018-01-28T06:20:00.000Z", "symbol": "XBTUSD", "open": 11777, "high": 11839.5, "low": 11765,
        "close": 11839, "trades": 836, "volume": 2129685, "vwap": 11816.1408, "lastSize": 1, "turnover": 18024744077,
        "homeNotional": 180.24744077, "foreignNotional": 2129685},
       {"timestamp": "2018-01-28T06:25:00.000Z", "symbol": "XBTUSD", "open": 11839, "high": 11840, "low": 11803,
        "close": 11815, "trades": 786, "volume": 1596793, "vwap": 11820.331, "lastSize": 1, "turnover": 13509590539,
        "homeNotional": 135.09590539000004, "foreignNotional": 1596793},
       {"timestamp": "2018-01-28T06:30:00.000Z", "symbol": "XBTUSD", "open": 11815, "high": 11826, "low": 11813.5,
        "close": 11825.5, "trades": 542, "volume": 1243592, "vwap": 11818.9339, "lastSize": 629,
        "turnover": 10523161149, "homeNotional": 105.23161149, "foreignNotional": 1243592},
       {"timestamp": "2018-01-28T06:35:00.000Z", "symbol": "XBTUSD", "open": 11825.5, "high": 11840, "low": 11815,
        "close": 11834.5, "trades": 528, "volume": 796601, "vwap": 11830.1195, "lastSize": 52, "turnover": 6733688582,
        "homeNotional": 67.33688581999999, "foreignNotional": 796601},
       {"timestamp": "2018-01-28T06:40:00.000Z", "symbol": "XBTUSD", "open": 11834.5, "high": 11888, "low": 11834,
        "close": 11850.5, "trades": 1207, "volume": 3906222, "vwap": 11868.0275, "lastSize": 3500,
        "turnover": 32917180110, "homeNotional": 329.1718011, "foreignNotional": 3906222},
       {"timestamp": "2018-01-28T06:45:00.000Z", "symbol": "XBTUSD", "open": 11850.5, "high": 11900, "low": 11850,
        "close": 11900, "trades": 1314, "volume": 3719726, "vwap": 11887.7794, "lastSize": 52, "turnover": 31290521309,
        "homeNotional": 312.90521309, "foreignNotional": 3719726},
       {"timestamp": "2018-01-28T06:50:00.000Z", "symbol": "XBTUSD", "open": 11900, "high": 11970, "low": 11899.5,
        "close": 11956, "trades": 1529, "volume": 6783639, "vwap": 11938.873, "lastSize": 979, "turnover": 56825507604,
        "homeNotional": 568.2550760400001, "foreignNotional": 6783639},
       {"timestamp": "2018-01-28T06:55:00.000Z", "symbol": "XBTUSD", "open": 11956, "high": 11956, "low": 11901,
        "close": 11916, "trades": 1220, "volume": 4277033, "vwap": 11923.2145, "lastSize": 158, "turnover": 35873416782,
        "homeNotional": 358.73416782000004, "foreignNotional": 4277033},
       {"timestamp": "2018-01-28T07:00:00.000Z", "symbol": "XBTUSD", "open": 11916, "high": 11960, "low": 11904,
        "close": 11932.5, "trades": 1228, "volume": 5822496, "vwap": 11937.4478, "lastSize": 2000,
        "turnover": 48780453481, "homeNotional": 487.80453480999984, "foreignNotional": 5822496},
       {"timestamp": "2018-01-28T07:05:00.000Z", "symbol": "XBTUSD", "open": 11932.5, "high": 11934, "low": 11908,
        "close": 11918, "trades": 1092, "volume": 2598292, "vwap": 11921.793, "lastSize": 500, "turnover": 21796239299,
        "homeNotional": 217.96239298999998, "foreignNotional": 2598292},
       {"timestamp": "2018-01-28T07:10:00.000Z", "symbol": "XBTUSD", "open": 11918, "high": 11920, "low": 11855,
        "close": 11864, "trades": 1056, "volume": 6660513, "vwap": 11893.4348, "lastSize": 947, "turnover": 56001806375,
        "homeNotional": 560.01806375, "foreignNotional": 6660513},
       {"timestamp": "2018-01-28T07:15:00.000Z", "symbol": "XBTUSD", "open": 11864, "high": 11877, "low": 11827.5,
        "close": 11860, "trades": 1397, "volume": 4994966, "vwap": 11849.7452, "lastSize": 11802,
        "turnover": 42154294980, "homeNotional": 421.54294980000014, "foreignNotional": 4994966},
       {"timestamp": "2018-01-28T07:20:00.000Z", "symbol": "XBTUSD", "open": 11860, "high": 11879.5, "low": 11845,
        "close": 11879, "trades": 971, "volume": 2205386, "vwap": 11863.8035, "lastSize": 50, "turnover": 18590854679,
        "homeNotional": 185.90854678999997, "foreignNotional": 2205386},
       {"timestamp": "2018-01-28T07:25:00.000Z", "symbol": "XBTUSD", "open": 11879, "high": 11880, "low": 11863.5,
        "close": 11867, "trades": 680, "volume": 1893033, "vwap": 11876.4846, "lastSize": 1, "turnover": 15940444382,
        "homeNotional": 159.40444381999998, "foreignNotional": 1893033},
       {"timestamp": "2018-01-28T07:30:00.000Z", "symbol": "XBTUSD", "open": 11867, "high": 11871.5, "low": 11855,
        "close": 11868.5, "trades": 541, "volume": 730487, "vwap": 11863.8035, "lastSize": 100, "turnover": 6157879914,
        "homeNotional": 61.57879914000001, "foreignNotional": 730487},
       {"timestamp": "2018-01-28T07:35:00.000Z", "symbol": "XBTUSD", "open": 11868.5, "high": 11879, "low": 11850,
        "close": 11850.5, "trades": 587, "volume": 1251448, "vwap": 11866.6192, "lastSize": 1050,
        "turnover": 10546837755, "homeNotional": 105.46837755, "foreignNotional": 1251448},
       {"timestamp": "2018-01-28T07:40:00.000Z", "symbol": "XBTUSD", "open": 11850.5, "high": 11857.5, "low": 11829,
        "close": 11829.5, "trades": 589, "volume": 1554840, "vwap": 11842.7286, "lastSize": 2500,
        "turnover": 13129711527, "homeNotional": 131.29711526999995, "foreignNotional": 1554840},
       {"timestamp": "2018-01-28T07:45:00.000Z", "symbol": "XBTUSD", "open": 11829.5, "high": 11846, "low": 11775,
        "close": 11815, "trades": 1041, "volume": 3329983, "vwap": 11807.7695, "lastSize": 100257,
        "turnover": 28204110209, "homeNotional": 282.04110209, "foreignNotional": 3329983},
       {"timestamp": "2018-01-28T07:50:00.000Z", "symbol": "XBTUSD", "open": 11815, "high": 11814.5, "low": 11777.5,
        "close": 11805, "trades": 1057, "volume": 3185970, "vwap": 11789.6722, "lastSize": 3723,
        "turnover": 27024710940, "homeNotional": 270.24710940000006, "foreignNotional": 3185970},
       {"timestamp": "2018-01-28T07:55:00.000Z", "symbol": "XBTUSD", "open": 11805, "high": 11817, "low": 11780,
        "close": 11783, "trades": 819, "volume": 1728882, "vwap": 11803.5883, "lastSize": 420, "turnover": 14648049976,
        "homeNotional": 146.48049976, "foreignNotional": 1728882},
       {"timestamp": "2018-01-28T08:00:00.000Z", "symbol": "XBTUSD", "open": 11783, "high": 11798, "low": 11780.5,
        "close": 11788.5, "trades": 631, "volume": 1234212, "vwap": 11788.2824, "lastSize": 2055,
        "turnover": 10469951259, "homeNotional": 104.69951258999996, "foreignNotional": 1234212},
       {"timestamp": "2018-01-28T08:05:00.000Z", "symbol": "XBTUSD", "open": 11788.5, "high": 11816, "low": 11787.5,
        "close": 11805.5, "trades": 604, "volume": 1334888, "vwap": 11803.5883, "lastSize": 1500,
        "turnover": 11309346786, "homeNotional": 113.09346786000005, "foreignNotional": 1334888},
       {"timestamp": "2018-01-28T08:10:00.000Z", "symbol": "XBTUSD", "open": 11805.5, "high": 11827.5, "low": 11800,
        "close": 11803.5, "trades": 855, "volume": 2118322, "vwap": 11816.1408, "lastSize": 1180,
        "turnover": 17928469432, "homeNotional": 179.28469431999994, "foreignNotional": 2118322},
       {"timestamp": "2018-01-28T08:15:00.000Z", "symbol": "XBTUSD", "open": 11803.5, "high": 11805, "low": 11785,
        "close": 11795, "trades": 654, "volume": 1448930, "vwap": 11796.6262, "lastSize": 1818, "turnover": 12283517589,
        "homeNotional": 122.83517589, "foreignNotional": 1448930}]

books = []
for i in ret:
    time_list = i['timestamp'].split('.')[0].split('T')
    book = [time_list[0], time_list[1], i['open'], i['high'], i['low'], i['close'], ]
    books.append(book)
# 如果 book 条数足够多的话，pandas 会每次往文件中写 50 条数据。

data = pd.DataFrame(books)
# 写入csv文件,'a+'是追加模式
try:
    if number == 1:
        csv_headers = ['data_NK_HS-YM', 'time', 'open', 'high', 'low', 'close']
        data.to_csv(fileName, header=csv_headers, mode='a+', encoding='utf-8')
    else:
        data.to_csv(fileName, header=False, mode='a', encoding='utf-8')
    number = number + 1
except UnicodeEncodeError:
    print("编码错误, 该数据无法写到文件中, 直接忽略该数据")

